## HTTP 요청 메세지 - 단순 텍스트

InputStream(Reader): HTTP 요청 메시지 바디의 내용을 직접 조회

OutputStream(Writer): HTTP 응답 메시지의 바디에 직접 결과 출력


```java
package hello.springmvc.basic.request;

@Slf4j
@Controller
public class RequestBodyStringController {

    @PostMapping("/request-body-string-v1")
    public void requestBodyString(HttpServletRequest request, 
                                  HttpServletResponse response) throws IOException {
        
        ServletInputStream inputStream = request.getInputStream();
        String messageBody = StreamUtils.copyToString(inputStream, StandardCharsets.UTF_8);
        
        log.info("messageBody={}", messageBody);

        response.getWriter().write("ok");
    }

}
```

<br/>

하기.

![이미지](/programming/img/서53.PNG)


<br/>


실행 시켜보면 잘 출력 된다.

![이미지](/programming/img/서54.PNG)

<br/>

이렇게 짧아질 수가 있다. 하지만 밑에 더 짧아 질 수 있다.

```java
package hello.springmvc.basic.request;

@Slf4j
@Controller
public class RequestBodyStringController {

    @PostMapping("/request-body-string-v2")
    public void requestBodyStringV2(InputStream inputStream, Writer responseWriter) throws IOException {
        String messageBody = StreamUtils.copyToString(inputStream, StandardCharsets.UTF_8);
        log.info("messageBody={}", messageBody);

        responseWriter.write("ok");
    }

}
```

<br/>

이렇게 짧아 질 수가 있다.

하지만 밑에 더 짧아 질 수 있다.

```java
package hello.springmvc.basic.request;

import lombok.extern.slf4j.Slf4j;
import org.springframework.http.HttpEntity;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.PostMapping;
import java.io.IOException;

@Slf4j
@Controller
public class RequestBodyStringController {
    
    @PostMapping("/request-body-string-v3")
    public HttpEntity<String> requestBodyStringV3(HttpEntity<String> httpEntity) throws IOException {

        String messageBody = httpEntity.getBody();

        log.info("messageBody={}", messageBody);

        return new HttpEntity<>("ok");
    }

}
```

<br/>

### 이게 마지막으로 짧아진 것이다.

### 이걸 실무에서 많이 사용한다.

<br/>

문자로 변환하는

`String messageBody = StreamUtils.copyToString(inputStream, StandardCharsets.UTF_8);`

이런 코드들을 내가 수정으로 직접 작성 했지만, 이젠 스프링이 알아서 다 해주는 것이다.

그 자동으로 해주는 애가 ‘HTTP 메시지 컨버터’(HttpMessageConverter) 인 것이다.

```java
@ResponseBody
@PostMapping("/request-body-string-v4")
public String requestBodyStringV3(@RequestBody String messageBody) {

    log.info("messageBody={}", messageBody);

    return "ok";
}
```

<br/>

실행시켜보면 이렇다.

![이미지](/programming/img/서55.PNG)

### `@RequestBody`

`@RequestBody` 를 사용하면 HTTP 메시지 바디 정보를 편리하게 조회할 수 있다. 

참고로 헤더 정보가 필요하다면 `HttpEntity` 를 사용하거나 `@RequestHeader` 를 사용하면 된다.

<br/>이렇게 메시지 바디를 직접 조회하는 기능은 요청 파라미터를 조회하는

`@RequestParam`, `@ModelAttribute` 와는 전혀 관계가 없다.

쉽게 생각해서 메세지 바디에 있는걸 다이렉트로 ‘콱’ 잡아서 가져 오는 것이다.

<br/>

## 요청 파라미터 vs HTTP 메시지 바디

### 요청 파라미터를 조회 할때는 이걸 사용: `@RequestParam` , `@ModelAttribute`

<br/>

### HTTP 메시지 바디를 직접 조회 할때는 이걸 사용: `@RequestBody`

<br/>



### `@ResponseBody` 를 사용하면 응답 결과를 HTTP 메시지 바디에 직접 담아서 전달할 수 있다.

물론 이 경우에도 view를 사용하지 않는다.

<br/>

## 스프링 mvc는 다음 파라미터를 지원한다.

- `HttpEntity`: HTTP header, body 정보를 편리하게 조회
    - 메시지 바디 정보를 직접 조회

    - 요청 파라미터를 조회하는 기능과 관계 없음 
    @RequestParam X, @ModelAttribute X
- `HttpEntity`는 응답에도 사용 가능

    - 메시지 바디 정보 직접 반환
    - 헤더 정보 포함 가능
    - view 조회X

<br/>

## HttpEntity 를 상속받은 다음 객체들도 같은 기능을 제공한다.

- `RequestEntity`

    - HttpMethod, url 정보가 추가, 요청에서 사용
- `ResponseEntity`
    - HTTP 상태 코드 설정 가능, 응답에서 사용
    
    - return new ResponseEntity<String>("Hello World", responseHeaders, HttpStatus.CREATED
    

<br/>

>**Reference** <br/>스프링 MVC 1편 - 백엔드 웹 개발 핵심 기술 - https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-mvc-1