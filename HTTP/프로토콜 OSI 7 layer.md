## 프로토콜 / OSI 7 layer

<br/>

## Network

컴퓨터나 기타 기기들이 리소스를 공유하거나 데이터를 주고 받기 위해 

유선 혹은 무선으로 연결된 통신 체계를 말한다.

<br/><br/>

## Network 기능

- 애플리케이션 목적에 맞는 통신 방법 제공

    - 즉, 애플리케이션 사이에서의 필요한 기능

- 신뢰할 수 있는 데이터 전송 방법 제공

    - 애플리케이션 사이에서 어떻게 데이터를 안정적으로 전송할지에 대한 기능

- 네트워크 간의 최적의 통신 경로 결정

- 목적지로 데이터 전송

    - 애플리케이션이 동작하고 있는 호스트 사이에서 어떻게 하면
        
         실제로 데이터를 실제로 목적지 까지 보낼지에 대한 기능
        
- 노드 사이의 데이터 전송
    - 목적지 까지 데이터를 보낼때, 여러 노드를 거치게 되는데,
        
        노드와 노드 사이에서는 어떻게 데이터를 전송할 것인가에 대한 기능이다.
        

```java
"그리하여 네트워크 여러 기능들을 계층구조로 만들어서 OSI model (7 layer)라고 부른다"
```

<br/><br/>

## 네트워크의 존재 이유는?

통신하기 위해 존재한다. → 즉, 약속된 통신 방법이 있어야 한다.

- 네트워크 통신을 하기 위해서 통신에 참여하는 주체들이
    
    따라야 하는 형식, 절차, 규약들을 → `네트워크 프로토콜`이라고 부른다.
    

```java
"Network의 모든 기능을 단 하나의 프로토콜로 구현 할 수 있을까?"
 -> 정답은 없다! 즉, 자바에서 모든 기능을 하나의 클래스에서 구현하겠다고 하는것과 같다.

그리하여 대책은 "모듈화" 를 하는 것이다.
```

<br/><br/>

## layered architecture (계층 구조)

- OSI model (7 layer) : 범용적인 네트워크 구조

- TCP/IP stack (4 layer) : 인터넷에 특화된 네트워크 구조

    - 인터넷이 발명되면서 함께 개발된 프로토콜 스택

    - 실제로 인터넷에서 사용되고 있는 스택

<br/><br/>

## OSI 7 layer

![이미지](/programming/img/입문565.PNG)

- 각 레이어에 맞게 프로토콜이 세분화돼서 구현된다.

- 각 레이어의 프로토콜은 하위 레이어의 프로토콜이 제공하는 기능을 사용하여 동작한다.

    - 즉, L3은 L2의 구현된 프로토콜을 사용해서 자신의 기능을 구현하게 된다는 것이다.

<br/><br/>

## application layer (L7)

```java
"애플리케이션에 필요한 통신 방법 제공한다"
```

애플리케이션 목적에 맞는 통신 방법을 제공한다.

- `HTTP 프로토콜`
    - 사용자에게 웹 페이지를 보여주고 싶다면, 양쪽의 어플리케이션이
        
        HTTP를 사용하여 통신을 하면 된다.
        
- `DNS 프로토콜`

    - 유튜브.com 처럼 도메인을 IP주소로 바꾸고 싶을때 사용한다.

- `SMTP 프로토콜`

    - 이메일을 주고 받는 기능을 구현하고 싶다면, SMTP 사용한다.

- `FTP 프로토콜`

    - 파일을 서버에 업로드하고, 다운로드하는 어플리케이션을 만들고 싶다면 FTP 를 사용한다.

<br/><br/>

## persentation layer (L6)

```java
"애플리케잇녀 간의 통신 메시지 포맷 관리한다"
```

애플리케이션 간의 통신에서 메시지 포맷을 관리한다.

- 즉, 보낸쪽에서는 어떤 캐릭터 셋 인코딩 했는지에 따라서, 받는쪽에는 그 캐릭터 셋으로 디코딩 해야 된다는 것이다.
    
    - 인코딩 <-> 디코딩

    - 암호화 <-> 복호화

    - 압축 <-> 압축 풀기

<br/><br/>

## session layer (L5)

```java
"애플리케이션 간의 통신 세션을 관리한다"
```

애플리케이션 간의 통신에서 세션을 관리하는 곳이다.

<br/>

### (L5) ~ (L7) 까지는

어플리케이션을 담당한다고 생각하면 된다.

<br/>

### transport layer (L4)

```java
"애플리케이션 간의 통신을 담당한다"
```

애플리케이션 간의 통신을 담당한다.

- 목적지 애플리케이션으로 데이터 전송하기 위해서 어떤식의 통신을 할것이냐? 를 결정한다.

- 안정적이고 신뢰할 수 있는 데이터 전송 보장 → (TCP)

- 필수 기능만 제공 (UDP)

    - 데이터가 중간에 유실 될 수도 있고, 데이터를 보낸 순서대로 받는 쪽에서 받지 못할 수도 있지만,
        
        어쨌든 해당하는 어플리케이션으로 데이터를 보내는 것이 UDP 이다.
        

```java
"어떻게 데이터가 목적지 까지 찾아가게 만들것인지에 대한것은 L4의 관심사가 아니다"
 이거에 대한 것은 -> L3의 관심사이다.

 그리하여 L4는 L3의 기능을 사용해서 어떤방식으로 어플리케이션까지 
 데이터를 전달 할것이냐? 정하게 되는 곳이다.
```

<br/><br/>

## network layer (L3)

```java
"호스트 간의 통신을 담당한다"
```

실제로 데이터를 목적지로 보내기 위해서, 

그 목적지로 찾아 갈 수 있도록 하는 프로토콜이 L3이다.

- 호스트 간의 통신 담당 (IP)

- 목적지 호스트로 데이터 전송

- 네트워크 간의 최적의 경로 결정

```java
이때 IP 주소를 활용하여 데이터를 전송하게 되는 것이다.
- 네트워크를 이루고 있는 라우터같은 장치들도 network layer에서 구현을 해줘야 하는 것이다.
```

<br/><br/>

## data link layer (L2)

```java
"직접 연결 노드 간의 통신을 담당한다"
```

- 직접 연결된 노드 간의 통신 담당한다

    - 즉, 장치와 라우터 간의 통신들을 말하는 것이다.

- MAC 주소 기반 통신한다. (ARP)

    - 여기서는 IP주소 기반이 아니라, MAC 주소라는 것을 사용한다

        - 이때 사용되는 프로토콜이 ARP라는 프로토콜이다.

<br/><br/>

## physical layer (L1)

```java
"bits 단위의 data를 전송한다"
```

- 실제로 물리적인 매개체를 통해서 케이블 일수도 있고, 무선의 신호 일수도 있을 것이다.
    
    그런 단위를 bits 단위로 데이터 전송하는 것을 말한다.
    
<br/><br/>


## 전체적인 동작 방식

애플리케이션 1과 애플리케이션 2가 있다고 가정해보자.

그리고 그 사이에 라우터 한개가 있다.

- 라우터는 → 통신을 할 수 있도록 만들어주는 장치이기 때문에

    - 라우터는 → 3개의 프로토콜을 구현하고 있다.

        - L1, L2, L3 까지 구현하고 있다.

<br/><br/>

## 그림으로 설명

![이미지](/programming/img/입문566.PNG)

애플리케이션 1에서 애플리케이션 2로 메시지를 보내는 시스템이라고 생각해보자.

1. 왼쪽 위에서 부터 → 밑으로 내려오면서 기능을 수행하기 위해 계속 포장이 된다.

2. L1까지 내려왔으면 라우터 L1으로 이동하게 된다.
    - 라우터는 포장지를 L1, L2, L3까지 뜯어 본다.

    - newwork layer을 보고, 어디로 가야하는지, 목적지 주소가 어딘지 확인한다.

    - 결론은, 최종적으로 목적지에 도착할 수 있도록 만들어주는 것이 L3인 것이다.

3. 목적지가 어딘지 알았다면, 라우터의 L1까지 다시 포장 한다

4. 그리하여 애플리케이션 2로 넘어오게 되고, 차례차례 포장지를 뜯어 가며 
    
    L7까지 올라가게 되고 마침네, 애플리케이션 2가 메시지를 받을 수 있게 되는 것이다.