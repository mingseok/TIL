## HTTP 메서드의 속성 (=멱등)

<br/>

## 멱등이란? (idempotent)

- 한번 호출하든 두번 호출하든 100번 호출하든 결과가 똑같다. 라고 생각하자.

- 멱등 메서드

    - GET: 한 번 조회하든, 두 번 조회하든 같은 결과가 조회된다.

    - PUT: 결과를 대체한다. 같은 요청을 여러번 해도 최종 결과는 같다.

    - DELETE: 결과를 삭제한다. 같은 요청을 여러번 해도 결과는 똑같다.

```java
"POST: 멱등이 아니다 -> 두번 호출하면 같은 결제가 중복해서 발생할 수 있다"
```

<br/><br/>

## 멱등을 사용하는 이유는?

- 자동 복구 메커니즘

    - e.g.) 서버가 타임아웃 등으로 정상 응답을 못주었을때,
        
        클라이언트가 같은 요청을 다시 해도 되는가? 에 판단 근거이다.
        

<br/>

### `delete` 를 생각한다면, `delete`를 호출 했는데, 서버에서 응답이 없다면?

- 잘 실행 되었는지, 아닌지 알 수가 없다.

그러면 다시 클라이언트가 자동으로 delete 를 재시도 할것이다.

<br/><br/>

## 이런 부분은 멱등하지 않는다.

멱등은 외부 요인으로 중간에 리소스가 변경되는 것 까지는 고려하지 않는다.

```java
사용자 1) : "GET" 요청 -> 나이 10
사용자 2) : "PUT" 요청 -> 나이 50

사용자 1) : "GET" 요청 -> 나이 50 -> "사용자2의 영향으로 데이터가 변경되었다"
```

<br/><br/>

## 중요) 응답 결과를 캐시에서 사용할 수 있을까?

만약에, 내가 웹브라우저에 이미지 큰 걸 요청한다.

그러면, 그 다음에 또 그 똑같은 리소스를 요청할 필요가 없는 것이다.

<br/>

똑같은 이미지를 또 다시 다운로드 받으려고 한다면 오래 걸릴 것이다.

```java
"이걸 내 로컬 pc에 저장을 하는 것이다. 이걸 캐시라고 한다"
```

여기서 get, head, post, patch는 캐시가 가능하다.

- 하지만, 실제로는 `get`, `head` 정도만 캐시로 사용한다.

- post, patch는 본문 내용까지 캐시 키로 고려해야 하는데, 구현이 쉽지 않다.