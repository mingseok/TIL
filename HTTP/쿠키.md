## 쿠키

• Set-Cookie: 서버에서 클라이언트로 쿠키 전달(응답)

• Cookie: 클라이언트가 서버에서 받은 쿠키를 저장하고, HTTP 요청시 서버로 전달


<br/>

### 예를 들어 보자.

사용자가 로그인을 하지 않았다.

![이미지](/programming/img/HTTP33.PNG)

<br/>

사용자가 로그인을 했다.

![이미지](/programming/img/HTTP34.PNG)

로그인 한 상태에서 창을 닫았다가 다시 welcom 페이지로 들어간다.


<br/>그런데 나는 아까 로그인을 하여 ‘홍길동’을 기대 했는데

로그인 하지 않은 ‘손님’을 주는 것이다.

여기서 서버 입장에서는 `GET /welcom HTTP/1.1` 만 온것이다. 

<br/>아무리 다시 봐도 `user=홍길동`은 눈에 보이지 않는다. (나도 보이지 않는다.)

이유는 무상태 프로토콜(=Stateless)이기 때문에 그런것이다.

 (=서로 상태를 유지하지 않기 때문에 그런 것이다)

<br/>자세한 설명은 밑밑 사진에 있음.

<br/>

### 무상태 프로토콜(=Stateless)란?

- HTTP는 무상태 프로토콜이다.

- 클라이언트와 서버가 요청과 응답을 주고 받으면 연결이 끊어진다.
- 클라이언트가 다시 요청하면 서버는 이전 요청을 기억하지 못한다.
- 클라이언트와 서버는 서로 상태를 유지하지 않는다.

<br/><br/>

![이미지](/programming/img/HTTP35.PNG)


<br/><br/>

## 옛날부터 이런 문제가 있었다. 그리하여, 쿠키란게 생겼다.

### 설명.

1. 서버 입장에서는 로그인이 성공하면 쿠키를 만드는 것이다.

2. 내 웹브라우저 내부에는 쿠키 저장소라는 곳이 있다.
3. user=홍길동 이라는 것을 저장을 해둔다.

![이미지](/programming/img/HTTP36.PNG)

<br/>그다음 

로그인 이후에 사용자가 /welcome 페이지를 닫고 다시 /welcome 페이지로 들어간다.

그러면 자동으로 내 웹브라우저는 쿠키값을 무조건 http 헤더에 넣어서 서버에게 보내는 것이다.

![이미지](/programming/img/HTTP37.PNG)

<br/><br/>

## 세선 + 쿠키 함께 사용. == 사용자 로그인 세션 관리

처음에 user=홍길동 으로 들어가서 서버한테서 쿠키를 받고, 그 쿠키를 바로 웹브라우저에 

저장하는 것은 엄청 위험하다. 이유는. 홍길동의 정보들이 다 노출되기 때문이다.

<br/>그리하여 처음에 서버쪽에서 로그인이 성공 되면, 세션 키라는 것을 서버에서 만들어서 

서버의 데이터 베이스에 저장을 해놓고, 다시 클라이언트에게 전달 할때는

‘user=홍길동’ 을 ‘세션id=값’ 으로 클라이언트에게 반환을 해주는 것이다.

<br/> 클라이언트는 그 사이트 요청을 보낼때 마다 내 브라우저에서‘세션id=값’ 을 계속 보내는 것이다. 

<br/>그러면 서버는 세션 id가 있으면 “아, 니가 홍길동이구나” 알 수 있게 되는 것이다.

**세션 키**는 이 세션의 기간동안 일시적으로 사용할 '키' 입니다. 

이 키로 암호화와 복호화를 진행하게 됩니다.

<br/>쿠키는 브라우저(클라이언트), 세션은 서버에서 관리하는 정보



세션 쿠키는 단순히 웹 브라우저 종료시 클라이언트에서 종료되고, 

영속 쿠키는 웹 브라우저가 종료되어도 클라이언트 시간이 남아 있는한 살아있습니다.

<br/>

### 세션은 세션은사실 쿠키로 구현이 되어 있다.

어떤 프로세스들 사이에서 (지금 같은 경우엔 브라우저와 웹서버) 서로를 인식한 이후, 

통신을 마칠때 까지의 기간 정도로 이해하면 된다.


<br/>

### 쿠키 - 생명주기

- 만료일이 되면 쿠키 삭제

세션 쿠키 : 만료 날짜를 생략하면 브라우저 종료시 까지만 유지

영속 쿠키 : 만료 날짜를 입력하면 해당 날짜까지 유지

<br/>


>**Reference** <br/>모든 개발자를 위한 HTTP 웹 기본 지식 : https://www.inflearn.com/course/http-%EC%9B%B9-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC