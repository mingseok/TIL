## 스프링 타입 컨버터

<br/>

문자를 숫자로 변환하거나, 반대로 숫자를 문자로 변환해야 하는 것 처럼 

애플리케이션을 개발하다 보면 타입을 변환해야 하는 경우가 상당히 많다.

코드로 보면 이런 상황이다.

```java
@RestController
public class HelloController {
    
    @GetMapping("/hello-v1")
    public String helloV1(HttpServletRequest request) {
        String data = request.getParameter("data"); //문자 타입 조회
        Integer intValue = Integer.valueOf(data); //숫자 타입으로 변경
        
        System.out.println("intValue = " + intValue);
        return "ok";
    }
}
```

<br/><br/>

### 스프링은 @RequestParam을 사용하여 타입 변환 과정을 하지 않는다.

```java
@RestController
public class HelloController {

    @GetMapping("/hello-v2")
    public String helloV2(@RequestParam Integer data) {
        System.out.println("data = " + data);
        return "ok";
    }
}
```

포인트는 `http://localhost:8080/hello-v2?data=10` → 10은 문자 “10” 이다. (숫자가 아님)

하지만, `@RequestParam` 사용하여 타입만 작성해 놓으면 그 타입에 맞게 스프링 내부에서 자동으로 변환해서 넣어 주는 것이다.

```
이러한 경우는 @ModelAttribute 와 @PathVariable 에서도 마찬가지이다.
```

<br/><br/>

## 스프링이 제공하는 기본 포맷터

- 화면에 숫자를 출력해야 하는데, `Integer` `String` 출력 시점에 숫자 `1000` , 문자 `"1,000"`
    
    이렇게 `1000` 단위에 쉼표를 넣어서 출력하거나, 또는 `"1,000"` 라는 문자를 `1000` 이라는 숫자로 변경해야 한다.
    
- 날짜 객체를 문자인 `"2021-01-01 10:50:11"` 와 같이 출력하거나 또는 그 반대의 상황이다.

```
숫자 1000 을 문자 "1,000" 으로 그러니까, 1000 단위로 쉼표가 들어가는 포맷을 적용
```

<br/>

스프링은 이런 문제를 해결하기 위해 애노테이션 기반으로 원하는 형식을 지정해서 

사용할 수 있는 매우 유용한 포맷터 두 가지를 기본으로 제공한다



### `@NumberFormat` :

숫자 관련 형식 지정 포맷터 사용, `NumberFormatAnnotationFormatterFactory`

### `@DateTimeFormat` :

날짜 관련 형식 지정 포맷터 사용, `Jsr310DateTimeFormatAnnotationFormatterFactory`

<br/><br/>

## 이런식으로 가능하다

```java
@Data
static class Form {
    @NumberFormat(pattern = "###,###") // 금액 포맷
    private Integer number;

    @DateTimeFormat(pattern = "yyyy-MM-dd HH:mm:ss") // 날짜 포맷
    private LocalDateTime localDateTime;
}
```

<br/><br/>

## 사용 방법

### `FormatterController` 주석 잘보기.

```java
@Controller
public class FormatterController {
    @GetMapping("/formatter/edit")
    public String formatterForm(Model model) {
        Form form = new Form();

        form.setNumber(10000);
        form.setLocalDateTime(LocalDateTime.now());

        model.addAttribute("form", form);
        return "formatter-form";
    }

    // "10,000" 문자가 여기로 들어온다. 그리고 여기서도 포맷이 적용된다.
    // 이유는? -> Form 클래스에도 포맷 애노테이션이 있기 때문이다.
    // 따라서 "10,000" 에서 -> 10000 으로 변환된다. (날짜도 같은 형식이다.)
    @PostMapping("/formatter/edit")
    public String formatterEdit(@ModelAttribute Form form) {
        return "formatter-view";
    }

    @Data
    static class Form {
        @NumberFormat(pattern = "###,###")
        private Integer number;

        @DateTimeFormat(pattern = "yyyy-MM-dd HH:mm:ss")
        private LocalDateTime localDateTime;
    }
}
```

<br/><br/>

### `formatter-form.html`

```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<form th:object="${form}" th:method="post">
    number <input type="text" th:field="*{number}"><br/>
    localDateTime <input type="text" th:field="*{localDateTime}"><br/>
    <input type="submit"/>
</form>
</body>
</html>
```

<br/><br/>

### `formatter-view.html`

`{}` 그냥 / `{{}}` 포멧 적용 하겠다는 뜻

```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<ul>
    <li>${form.number}: <span th:text="${form.number}"></span></li>
    <li>${{form.number}}: <span th:text="${{form.number}}"></span></li>
    <li>${form.localDateTime}: <span th:text="${form.localDateTime}"></span></li>
    <li>${{form.localDateTime}}: <span th:text="${{form.localDateTime}}"></span></li>
</ul>
</body>
</html>
```

<br/><br/>

## 출력 시켜보기

![이미지](/programming/img/입문154.PNG)

<br/>

![이미지](/programming/img/입문155.PNG)

- 1번째 포맷 적용하지 않은 것.

- 2번째 포맷 적용 한 것.
- 3번째 포맷 적용하지 않은 것.
- 4번째 포맷 적용 한것.


<br/><br/>

>**Reference** <br/>[스프링 MVC 2편 - 백엔드 웹 개발 활용 기술](https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-mvc-2/dashboard)