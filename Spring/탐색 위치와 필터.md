## 탐색 위치와 기본 스캔 대상

이렇게 작성하면 “hello.core” 파일 안에 있는 것들만 컴포넌트 스캔 대상이 되는 것이다.

```java
package hello.core;

import hello.core.member.MemberRepository;
import hello.core.member.MemoryMemberRepository;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.FilterType;

@Configuration
@ComponentScan(
        basePackages = "hello.core",
        excludeFilters = @ComponentScan.Filter(type = FilterType.ANNOTATION, 
                                    classes = Configuration.class)
)
public class AutoAppConfig {

/*
    @Bean(name = "memoryMemberRepository")
    MemberRepository memberRepository() {
        return new MemoryMemberRepository();
    }
*/

}
```

<br/>즉, 이렇게 사용하면 어디서 부터 찾을지 지정할 수 있다.

하는 이유는?? 이게 없다면 모든 자바 코드부터 하여 라이브러리 까지 뒤적뒤적하기 때문에 

엄청 오래 걸릴 것이다.

<br/>

## 만약 아무것도 안 붙이고 디폴트로 한다면??

지정하지 않으면 `@ComponentScan` 을 붙인 클래스의 맨위인 `package` 를 보면 

hello.core 라고 되어 있는데 여기서 부터 찾게 되는 것이다.

즉, 지정하지 않으면 @ComponentScan 이 붙은 설정 정보 클래스의 패키지가 시작 위치가 된다.

<br/>

## 컴포넌트 스캔 기본 대상

컴포넌트 스캔은 @Component 뿐만 아니라 다음과 내용도 추가로 대상에 포함한다.

- @Component : 컴포넌트 스캔에서 사용

- @Controlller : 스프링 MVC 컨트롤러에서 사용
- @Service : 스프링 비즈니스 로직에서 사용@Repository : 스프링 데이터 접근 계층에서 사용
- @Configuration : 스프링 설정 정보에서 사용

---

<br/><br/>

## 필터

`includeFilters` : 컴포넌트 스캔 대상을 추가로 지정한다.

`excludeFilters` : 컴포넌트 스캔에서 제외할 대상을 지정한다.

<br/>

`MyIncludeComponent` 테스크 코드

`annotation` 을 직접 만들어주는 것이다. 인터페이스

<br/>

`@Target`, `@Retention`, `@Documented` 는 내가 작성해야됨.

“애가 붙은거는 컴포넌트 스캔에 추가할거야!!” 라고 생각하면 되는 것이다.

<br/>헷갈리지 말기. 이거는 어너테이션을 만드는 과정이다.

다른 곳에서 @MyIncludeComponent 이렇게 사용하면 되는 것이다.

```java
package hello.core.scan.filter;

import java.lang.annotation.*;

@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Documented
public @interface MyIncludeComponent {
    
}
```

<br/>

`MyExcludeComponent` 테스크 코드

“애가 붙은애는 컴포넌트 스캔에서 제외 할거야!!” 라고 생각하면 된다.

```java
package hello.core.scan.filter;

import java.lang.annotation.*;

@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Documented
public @interface MyExcludeComponent {

}
```


<br/><br/>

### 이렇게 사용하는 것이다.

`BeanA` 테스트 코드

```java
package hello.core.scan.filter;

@MyIncludeComponent
public class BeanA {
    
}
```

<br/>

### 이렇게 사용하는 것이다.

`BeanB` 테스트 코드

그러면 애는 컴포넌트 스캔에서 제외 되는 것이다.

```java
package hello.core.scan.filter;

@MyExcludeComponent
public class BeanB {
    
}
```

<br/>


`ComponentFilterAppConfigTest` 테스트 코드

```java
package hello.core.scan.filter;

import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.NoSuchBeanDefinitionException;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.FilterType;

import static org.junit.jupiter.api.Assertions.*;

public class ComponentFilterAppConfigTest {

    @Test
    void filterScan() {
        ApplicationContext ac = 
								new AnnotationConfigApplicationContext(ComponentFilterAppConfig.class);
        
				BeanA beanA = ac.getBean("beanA", BeanA.class);
        Assertions.assertThat(beanA).isNotNull();

        //만약
        // ac.getBean("beanB", BeanB.class); 하면 테스트 코드 실패.
        assertThrows(
                NoSuchBeanDefinitionException.class,
                () -> ac.getBean("beanB", BeanB.class));
    }

    @Configuration
    @ComponentScan(
            includeFilters = @ComponentScan.Filter(type = FilterType.ANNOTATION,
                    classes = MyIncludeComponent.class),
            excludeFilters = @ComponentScan.Filter(type = FilterType.ANNOTATION,
                    classes = MyExcludeComponent.class)
    )
    static class ComponentFilterAppConfig {

    }

}
```

<br/>

### 참고: @Component 면 충분하기 때문에, includeFilters 를 사용할 일은 거의 없다. 

excludeFilters는 여러가지 이유로 간혹 사용할 때가 있지만 많지는 않다.


<br/>


>**Reference** <br/>스프링 핵심 원리 - 기본편 : https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-%ED%95%B5%EC%8B%AC-%EC%9B%90%EB%A6%AC-%EA%B8%B0%EB%B3%B8%ED%8E%B8
