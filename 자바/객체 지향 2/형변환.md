## 형변환

작은 자료형에서 큰 자료형의 형변환은 생략이 가능하듯이, <br/>자손타입의 참조변수를 조상타입으로 형변환하는 경우에는 형변환을 생략할 수 있다.

<br/>

**자손타입 → 조상타입 : 형변환 생략가능**

**자손타입 ← 조상타입 : 형변환 생략불가**

<br/>

조상타입의 참조변수를 자손타입의 참조변수로 변환하는 것을 다운캐스팅이라고 하며, <br/>자손타입의 참조변수를 조상타입의 참조변수로 변환하는 것을 업캐스팅이라고 한다.

<br/>

**괄호 ( ) 안에 변환하고자 하는 타입의 이름( 클래스 ) 을 적어주면 되는 것이다.**

**그리고 형변환은 상속관계 에서만 가능한 것이다. 형제관계는 안된다.**

### <br/>Car타입 참조변수와 FireEngine 타입 참조변수 간의 형변환을 예로 들어 보자.

```java
Car car = null;
FireEngine fe = new FireEngine();
FireEngine fe2 = null;

car = fe; // car = (Car) fe; 에서 형변환 생략됨. 업캐스팅
fe2  = (FireEngine) car; // 형변환을 생략불가. 다운 캐스팅
```

<br/>

### 헷갈리지 말기.

다운캐스팅은 타입만 영향이 있을뿐이다.!! 그 이상 그 이하도 없다 !!

원래 타입이 똑같아야 대입이 된다.

여기서도 똑같다. car 는 car 만 대입 되고, FireEngine 은 FireEngine 만 대입 된다. 

<br/>이걸 깨기 위해 형변환을 하는 것이다.

업캐스팅 - 자손이 부모 타입을 바뀔때는 상관이 없다. 뭐가? 명시 해줄 필요가 없단 끝이다.

문제는 밑에 있다.

<br/>다운캐스팅 - FireEngine 에 car 타입을 넣어야 되는데 되지 않는 것이다.<br/> 이럴땐 다운캐스팅을 하는 것이다. <br/><br/>그렇지만 이것은 문제가 될 수도 있다. 그렇기에 우리 눈에 명시를 해줘야 하는 것이다.<br/> 즉, FireEngine 에 car 타입을 넣을때는 다운캐스팅을 명시 해줘야 하는 것이다.

<br/>예제 1.

```java
package test;

class Car {
	String color;
	int door;

	void drive() {
		System.out.println("drive, Brrr ~");
	}

	void stop() {
		System.out.println("stop!!");
	}

}

class FireEngine extends Car {
	void water() {
		System.out.println("water!!");
	}
}

public class Test1 {

	public static void main(String[] args) {

		Car car = null;
		FireEngine fe = new FireEngine();
		FireEngine fe2 = null;
		
		fe.water();
		car = fe;
		car.water(); // 에러 발생.
		fe2 = (FireEngine) car;
		fe2.water();
		
	}

}

출력값
water!!
water!!

```

<br/><br/>설명과 함께 있는 예제 2.
```java
package test;

class Car {
	String color;
	int door;

	void drive() {
		System.out.println("drive, Brrrr");
	}

	void stop() {
		System.out.println("stop");
	}
}

class FireEngine extends Car {
	void water() {
		System.out.println("water!!");
	}
}

class Test2 {
	public static void main(String[] args) {
  
  	//-------------------------테스트 1------------------------------
	  /* 
	  Car car = new Car();
		Car car2 = null;
		FireEngine fe = new FireEngine();

		car.drive();
   	// fe = (FireEngine) car; 에러. -> 이유는? 부모클래스에서 자식클래스를 사용하려고 하는데,
                                    // 오버라이딩은 자식이 부모걸 가져와서 사용하는거라 부모클래스 입장에서는 
                                    // 자식타입에 뭐가 있는지 모르기 때문에 사용할 수 없다.
                                    
		fe.drive(); // (상속 관계라 drive 사용가능.)
		car2 = fe;
		// car2.water; 에러. 자식타입에 있는 water 라서 안된다.
		car2.drive(); 
	  */  
		
  	//-------------------------테스트 2------------------------------
	 /* Car car = new FireEngine(); // car 타입이고 객체는 FireEngine 객체인 것이다. 
                                  // 객체로 보자면 0x100 주소에 전체를 사용할 수 있지만,
                                  // car 타입은 자식꺼는 사용못하니 water() 은 사용할수 없는 것이다.
	    				                    // (상속 관계는 필수로 생각하자.)
	    				                    
	    Car car2 = null;
	    FireEngine fe = null;

		
	 // car.water(); 에러
	    car.drive();
   	  fe = (FireEngine) car; // car가 참조하고 있는 것은 new FireEngine(); 이기 때문에 가능하다. 

   	    			   // 왜? FireEngine 클래스는 car를 상속 받았기 때문에 사용할 수 있게된 것이다.
   	    			   // 즉, car 클래스 이지만 참조값은 FireEngine 인스턴스 이기에 car의 객체들을 사용할 수 있는것이다. (상속이 중요)

   	    			   // 다시 말하면 car = new FireEngine(); 이기 때문에 결국, 들어가는 것은
   	    			   // 다운캐스팅 하는 (FireEngine) 이 들어가는 것이다
   	    					   
   	    			   // 'car' 변수의 타입은 원래 car 타입 이니깐 다운캐스팅에 의해 (FireEngine) 명시 해준걸로 내려 fe가 된것이고,
   	    			   // 'car' 변수 안에 들어 있는 값은 new FireEngine() 인스턴스인 주소값이 fe에 참조 되는 것이다.   
   	    
   	fe.water();
		fe.drive();
		car2 = fe;
		car2.drive(); 
  	*/		
			
  	//-------------------------테스트 3------------------------------
 /* Car car = new Car();
		Car car2 = null;
		FireEngine fe = null;

		car.drive();
   	// fe = (FireEngine) car;    에러 발생. 
				      // 이유는, 헷갈리지 말기 !! 
              (FireEngine) 이렇게 다운캐스팅 하는건 타입만 바꾼다는 것이다. 그 이상, 그 이하도 없음. 

		   		    // car 클래스에서 FireEngine 으로 다운캐스팅 했고, 'car' 변수에는 new Car(); 인스턴스가 들어 있다.

				      // 여기서 Car 인스턴스 참조값 안에는 FireEngine 객체가 없다. 
				      // 즉, FireEngine 클래스가 가지고 있는 메서드 water() 가 없는 것이다. 이건 FireEngine 만 가지고 있는 것.

				      // 즉, car는 조상클래스라서 상속을 당한 입장이다. 그렇기에 water()가 없는 것이다.

				      // 그렇기에 에러 발생.

		// fe.drive(); // 에러 발생.
		car2 = fe;
		// car2.drive();
	 */

		
	//	보는 시점 
	//	1. 다운캐스팅 되는걸 보고, 그냥 타입만 바뀌는 타입으로 변경 되었다 생각하면 되는 것이다.
	//	2. 다운 캐스팅 되는 변수가 인스턴스를 참조 하고 있는지 확인하기. (new Car();)
	//	3. 'car' 변수 안에 무슨 인스턴스가 참조하고 있는지 확인하기.
	//	4. car 가 조상 클래스이면 FireEngine 클래스에서 새로 추가된 내용이 car에서
    	// 없기 때문에 에러가 발생하는 것이다. 
		
	}
}
```

<br/><br/>

>**Reference**
><br/>남궁 성 지음, 『자바의 정석』, 도우출판.
